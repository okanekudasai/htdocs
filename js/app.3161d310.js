(function(e){function t(t){for(var n,r,o=t[0],c=t[1],u=t[2],l=0,p=[];l<o.length;l++)r=o[l],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,u||[]),s()}function s(){for(var e,t=0;t<a.length;t++){for(var s=a[t],n=!0,o=1;o<s.length;o++){var c=s[o];0!==i[c]&&(n=!1)}n&&(a.splice(t--,1),e=r(r.s=s[0]))}return e}var n={},i={app:0},a=[];function r(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=n,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var d=c;a.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"56d7":function(e,t,s){"use strict";s.r(t);var n=s("2b0e"),i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container",attrs:{id:"main-container"}},[e.session?e._e():s("div",{attrs:{id:"join"}},[e._m(0),s("div",{staticClass:"jumbotron vertical-center",attrs:{id:"join-dialog"}},[s("h1",[e._v("Join a video session")]),s("div",{staticClass:"form-group"},[s("p",[s("label",[e._v("Participant")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.myUserName,expression:"myUserName"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:e.myUserName},on:{input:function(t){t.target.composing||(e.myUserName=t.target.value)}}})]),s("p",[s("label",[e._v("Session")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.mySessionId,expression:"mySessionId"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:e.mySessionId},on:{input:function(t){t.target.composing||(e.mySessionId=t.target.value)}}})]),s("p",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-lg btn-success",on:{click:function(t){return e.joinSession()}}},[e._v(" Join! ")])])])])]),e.session?s("div",{attrs:{id:"session"}},[s("div",{attrs:{id:"session-header"}},[s("h1",{attrs:{id:"session-title"}},[e._v(e._s(e.mySessionId))]),s("input",{staticClass:"btn btn-large btn-danger",attrs:{type:"button",id:"buttonLeaveSession",value:"Leave session"},on:{click:e.leaveSession}})]),s("div",{staticClass:"col-md-6",attrs:{id:"main-video"}},[s("user-video",{attrs:{"stream-manager":e.mainStreamManager}})],1),s("div",{staticClass:"col-md-6",attrs:{id:"video-container"}},[s("user-video",{attrs:{"stream-manager":e.publisher},nativeOn:{click:function(t){return e.updateMainVideoStreamManager(e.publisher)}}}),e._l(e.subscribers,(function(t){return s("user-video",{key:t.stream.connection.connectionId,attrs:{"stream-manager":t},nativeOn:{click:function(s){return e.updateMainVideoStreamManager(t)}}})}))],2)]):e._e()])},a=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"img-div"}},[s("img",{attrs:{src:"resources/images/openvidu_grey_bg_transp_cropped.png"}})])}],r=s("3d9c"),o=s("bc3a"),c=s.n(o),u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.streamManager?s("div",[s("ov-video",{attrs:{"stream-manager":e.streamManager}}),s("div",[s("p",[e._v(e._s(e.clientData))])])],1):e._e()},d=[],l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("video",{attrs:{autoplay:""}})},p=[],m={name:"OvVideo",props:{streamManager:Object},mounted(){this.streamManager.addVideoElement(this.$el)}},v=m,h=s("2877"),b=Object(h["a"])(v,l,p,!1,null,null,null),f=b.exports,g={name:"UserVideo",components:{OvVideo:f},props:{streamManager:Object},computed:{clientData(){const{clientData:e}=this.getConnectionData();return e}},methods:{getConnectionData(){const{connection:e}=this.streamManager.stream;return JSON.parse(e.data)}}},y=g,S=Object(h["a"])(y,u,d,!1,null,null,null),_=S.exports;c.a.defaults.headers.post["Content-Type"]="application/json";const O="https://demos.openvidu.io/";var M={name:"App",components:{UserVideo:_},data(){return{OV:void 0,session:void 0,mainStreamManager:void 0,publisher:void 0,subscribers:[],mySessionId:"SessionA",myUserName:"Participant"+Math.floor(100*Math.random())}},methods:{joinSession(){this.OV=new r["OpenVidu"],this.session=this.OV.initSession(),this.session.on("streamCreated",({stream:e})=>{const t=this.session.subscribe(e);this.subscribers.push(t)}),this.session.on("streamDestroyed",({stream:e})=>{const t=this.subscribers.indexOf(e.streamManager,0);t>=0&&this.subscribers.splice(t,1)}),this.session.on("exception",({exception:e})=>{console.warn(e)}),this.getToken(this.mySessionId).then(e=>{this.session.connect(e,{clientData:this.myUserName}).then(()=>{let e=this.OV.initPublisher(void 0,{audioSource:void 0,videoSource:void 0,publishAudio:!0,publishVideo:!0,resolution:"640x480",frameRate:30,insertMode:"APPEND",mirror:!1});this.mainStreamManager=e,this.publisher=e,this.session.publish(this.publisher)}).catch(e=>{console.log("There was an error connecting to the session:",e.code,e.message)})}),window.addEventListener("beforeunload",this.leaveSession)},leaveSession(){this.session&&this.session.disconnect(),this.session=void 0,this.mainStreamManager=void 0,this.publisher=void 0,this.subscribers=[],this.OV=void 0,window.removeEventListener("beforeunload",this.leaveSession)},updateMainVideoStreamManager(e){this.mainStreamManager!==e&&(this.mainStreamManager=e)},async getToken(e){const t=await this.createSession(e);return await this.createToken(t)},async createSession(e){const t=await c.a.post(O+"api/sessions",{customSessionId:e},{headers:{"Content-Type":"application/json"}});return t.data},async createToken(e){const t=await c.a.post(O+"api/sessions/"+e+"/connections",{},{headers:{"Content-Type":"application/json"}});return t.data}}},w=M,j=Object(h["a"])(w,i,a,!1,null,null,null),x=j.exports;n["a"].config.productionTip=!1,new n["a"]({render:e=>e(x)}).$mount("#app")}});
//# sourceMappingURL=app.3161d310.js.map